(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[370],{4349:function(e,s,t){Promise.resolve().then(t.bind(t,5802))},5802:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return a}});var n=t(1804),c=t(8555);function a(){let[e,s]=(0,c.useState)([]),[t,a]=(0,c.useState)(null),d=async()=>{let e=await fetch("/api/dsar/requests");s((await e.json()).items)};return(0,c.useEffect)(()=>{d()},[]),(0,n.jsxs)("div",{className:"p-6 space-y-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold",children:"DSAR Console"}),(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"text-left",children:"ID"}),(0,n.jsx)("th",{children:"Sujeto"}),(0,n.jsx)("th",{children:"Tipo"}),(0,n.jsx)("th",{children:"Estado"}),(0,n.jsx)("th",{children:"Vence"}),(0,n.jsx)("th",{})]})}),(0,n.jsx)("tbody",{children:e.map(e=>(0,n.jsxs)("tr",{className:"border-t",children:[(0,n.jsx)("td",{className:"py-2",children:e.id.slice(0,8)}),(0,n.jsx)("td",{children:e.subjectId}),(0,n.jsx)("td",{children:e.type}),(0,n.jsx)("td",{children:e.status}),(0,n.jsx)("td",{children:new Date(e.dueAt).toLocaleDateString()}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:"px-2 py-1 border rounded",onClick:async()=>{a(await fetch("/api/dsar/requests/".concat(e.id)).then(e=>e.json()))},children:"Ver"})})]},e.id))})]}),t&&(0,n.jsxs)("div",{className:"p-4 border rounded space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h2",{className:"text-xl font-medium",children:["Solicitud ",t.id]}),(0,n.jsx)("span",{className:"text-sm text-gray-500",children:t.status})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{className:"px-3 py-2 border rounded",onClick:()=>fetch("/api/dsar/requests/".concat(t.id,"/verify"),{method:"POST"}).then(d),children:"Verificar"}),(0,n.jsx)("button",{className:"px-3 py-2 border rounded",onClick:()=>fetch("/api/dsar/requests/".concat(t.id,"/approve"),{method:"POST"}).then(d),children:"Aprobar"}),(0,n.jsx)("button",{className:"px-3 py-2 border rounded",onClick:()=>fetch("/api/dsar/requests/".concat(t.id,"/export"),{method:"POST"}).then(d),children:"Export"}),(0,n.jsx)("button",{className:"px-3 py-2 border rounded",onClick:()=>fetch("/api/dsar/requests/".concat(t.id,"/erase"),{method:"POST"}).then(d),children:"Borrar/Anon"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold",children:"Artefactos"}),(0,n.jsx)(r,{id:t.id})]})]})]})}function r(e){let{id:s}=e,[t,a]=c.useState([]);return(0,c.useEffect)(()=>{fetch("/api/dsar/requests/".concat(s,"/artifacts")).then(e=>e.json()).then(e=>a(e.items))},[s]),(0,n.jsx)("ul",{className:"list-disc pl-6",children:t.map(e=>(0,n.jsxs)("li",{children:[e.name," — ",e.sha256.slice(0,12),"…",(0,n.jsx)("a",{className:"ml-2 underline",href:"/files?path=".concat(encodeURIComponent(e.path)),target:"_blank",children:"Descargar"})]},e.id))})}}},function(e){e.O(0,[239,299,744],function(){return e(e.s=4349)}),_N_E=e.O()}]);