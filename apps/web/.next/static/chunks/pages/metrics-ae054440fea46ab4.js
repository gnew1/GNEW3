(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[41],{7986:function(e,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/metrics",function(){return n(2146)}])},2146:function(e,i,n){"use strict";n.r(i),n.d(i,{default:function(){return h}});var l=n(7458),s=n(2983),t=n(1604),r=n(1549);function d(e){return(0,r.jsx)("button",{...e,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #ddd",background:"#fff",cursor:"pointer",...e.style||{}}})}function o({title:e,children:i}){return(0,r.jsxs)("div",{style:{border:"1px solid #eee",borderRadius:12,background:"#fff"},children:[e&&(0,r.jsx)("div",{style:{padding:"10px 14px",borderBottom:"1px solid #eee",fontWeight:600},children:e}),(0,r.jsx)("div",{style:{padding:"10px 14px"},children:i})]})}function a({data:e,xKey:i,yKey:n,height:l=240,...s}){let t=e[0]?.data??[];if(0===t.length)return(0,r.jsx)("div",{style:{height:l},children:"No data"});let d=t.map(e=>e.y),o=Math.min(...d),a=Math.max(...d),c=e=>l-(l-20)*(e-o)/(a-o||1)-10,u=t.map((e,i)=>`${i/(t.length-1)*600},${c(e.y)}`).join(" ");return(0,r.jsx)("svg",{width:"100%",viewBox:`0 0 600 ${l}`,height:l,...s,children:(0,r.jsx)("polyline",{fill:"none",stroke:"#2563eb",strokeWidth:2,points:u})})}let c="http://localhost:8007";function u(e){return"number"==typeof e?e.toLocaleString():"-"}function h(){var e,i,n;let{data:r={},isLoading:h}=(0,t.ZP)("".concat(c,"/metrics/summary"),e=>fetch(e).then(e=>e.json()),{refreshInterval:1e4}),p=(0,s.useMemo)(()=>{let e=Date.now();return[{id:"posts",data:Array.from({length:8}).map((i,n)=>{var l;return{x:new Date(e-(7-n)*6e4).toISOString(),y:((null==r?void 0:null===(l=r.participation)||void 0===l?void 0:l.posts)||0)*(.9+.2*Math.random())}})}]},[r]),x=e=>{let i="".concat(c,"/metrics/").concat(e,"?format=csv");if("undefined"!=typeof document){let n=document.createElement("a");n.href=i,n.download="".concat(e,".csv"),n.click()}else location.assign(i)};if(h)return(0,l.jsx)("div",{style:{padding:16},children:"Cargando m\xe9tricas…"});let j=null==r?void 0:r.participation,v=null==r?void 0:r.times,g=null==r?void 0:r.delegation;return(0,l.jsxs)("div",{style:{maxWidth:1200,margin:"0 auto",padding:16},children:[(0,l.jsx)("h1",{style:{fontFamily:"Inter, sans-serif",fontSize:28,marginBottom:12},children:"Dashboard \xb7 M\xe9tricas Clave"}),(0,l.jsxs)("div",{style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[(0,l.jsxs)(o,{title:"Participaci\xf3n",children:[(0,l.jsxs)("ul",{style:{lineHeight:1.8},children:[(0,l.jsxs)("li",{children:["Usuarios activos: ",(0,l.jsx)("b",{children:u(null==j?void 0:j.active_users)})]}),(0,l.jsxs)("li",{children:["Posts: ",(0,l.jsx)("b",{children:u(null==j?void 0:j.posts)})]}),(0,l.jsxs)("li",{children:["Votos: ",(0,l.jsx)("b",{children:u(null==j?void 0:j.votes)})]})]}),(0,l.jsx)("div",{style:{marginTop:8,display:"flex",gap:8},children:(0,l.jsx)(d,{onClick:()=>x("participation"),children:"Exportar CSV"})})]}),(0,l.jsxs)(o,{title:"Tiempos (respuesta)",children:[(0,l.jsxs)("ul",{style:{lineHeight:1.8},children:[(0,l.jsxs)("li",{children:["Promedio 1\xaa respuesta: ",(0,l.jsxs)("b",{children:[u(null==v?void 0:v.avg_first_response_seconds),"s"]})]}),(0,l.jsxs)("li",{children:["P50: ",(0,l.jsxs)("b",{children:[u(null==v?void 0:v.p50_seconds),"s"]})]}),(0,l.jsxs)("li",{children:["P90: ",(0,l.jsxs)("b",{children:[u(null==v?void 0:v.p90_seconds),"s"]})]})]}),(0,l.jsx)("div",{style:{marginTop:8,display:"flex",gap:8},children:(0,l.jsx)(d,{onClick:()=>x("times"),children:"Exportar CSV"})})]}),(0,l.jsxs)(o,{title:"Delegaci\xf3n",children:[(0,l.jsxs)("ul",{style:{lineHeight:1.8},children:[(0,l.jsxs)("li",{children:["Delegaciones activas: ",(0,l.jsx)("b",{children:u(null==g?void 0:g.active_delegations)})]}),(0,l.jsxs)("li",{children:["Top delegados: ",(0,l.jsx)("b",{children:null!==(n=null==g?void 0:null===(i=g.top_delegates)||void 0===i?void 0:null===(e=i[0])||void 0===e?void 0:e.user)&&void 0!==n?n:"–"})]})]}),(0,l.jsx)("div",{style:{marginTop:8,display:"flex",gap:8},children:(0,l.jsx)(d,{onClick:()=>x("delegation"),children:"Exportar CSV"})})]})]}),(0,l.jsx)(o,{title:"Tendencia de publicaciones (mock de ejemplo)",children:(0,l.jsx)(a,{data:p,xKey:"x",yKey:"y",height:280,"aria-label":"Tendencia de posts"})}),(0,l.jsx)("div",{style:{marginTop:8},children:(0,l.jsx)(d,{onClick:()=>x("summary"),children:"Exportar CSV (Resumen)"})}),(0,l.jsxs)("p",{style:{marginTop:8,color:"#6b7280"},children:["Actualizado: ",new Date((null==r?void 0:r.generated_at)||Date.now()).toLocaleString()]})]})}}},function(e){e.O(0,[551,888,774,179],function(){return e(e.s=7986)}),_N_E=e.O()}]);