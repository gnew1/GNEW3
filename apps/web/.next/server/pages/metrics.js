"use strict";(()=>{var e={};e.id=41,e.ids=[41,660],e.modules={1499:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},7095:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.r(t),r.d(t,{config:()=>m,default:()=>x,getServerSideProps:()=>f,getStaticPaths:()=>g,getStaticProps:()=>h,reportWebVitals:()=>j,routeModule:()=>_,unstable_getServerProps:()=>v,unstable_getServerSideProps:()=>S,unstable_getStaticParams:()=>b,unstable_getStaticPaths:()=>P,unstable_getStaticProps:()=>y});var s=r(3307),n=r(3678),a=r(1499),l=r(4176),o=r.n(l),d=r(4444),c=r.n(d),p=r(9441),u=e([p]);p=(u.then?(await u)():u)[0];let x=(0,a.l)(p,"default"),h=(0,a.l)(p,"getStaticProps"),g=(0,a.l)(p,"getStaticPaths"),f=(0,a.l)(p,"getServerSideProps"),m=(0,a.l)(p,"config"),j=(0,a.l)(p,"reportWebVitals"),y=(0,a.l)(p,"unstable_getStaticProps"),P=(0,a.l)(p,"unstable_getStaticPaths"),b=(0,a.l)(p,"unstable_getStaticParams"),v=(0,a.l)(p,"unstable_getServerProps"),S=(0,a.l)(p,"unstable_getServerSideProps"),_=new s.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/metrics",pathname:"/metrics",bundlePath:"",filename:""},components:{App:c(),Document:o()},userland:p});i()}catch(e){i(e)}})},9441:(e,t,r)=>{r.a(e,async(e,i)=>{try{r.r(t),r.d(t,{default:()=>u});var s=r(997),n=r(6689),a=r(5941),l=r(2411),o=r(5457),d=r(4640),c=e([a]);a=(c.then?(await c)():c)[0];let x="http://localhost:8007";function p(e){return"number"==typeof e?e.toLocaleString():"-"}function u(){let{data:e={},isLoading:t}=(0,a.default)(`${x}/metrics/summary`,e=>fetch(e).then(e=>e.json()),{refreshInterval:1e4}),r=(0,n.useMemo)(()=>{let t=Date.now(),r=Array.from({length:8}).map((r,i)=>({x:new Date(t-(7-i)*6e4).toISOString(),y:(e?.participation?.posts||0)*(.9+.2*Math.random())}));return[{id:"posts",data:r}]},[e]),i=e=>{let t=`${x}/metrics/${e}?format=csv`;if("undefined"!=typeof document){let r=document.createElement("a");r.href=t,r.download=`${e}.csv`,r.click()}else location.assign(t)};if(t)return s.jsx("div",{style:{padding:16},children:"Cargando m\xe9tricas…"});let c=e?.participation,u=e?.times,h=e?.delegation;return(0,s.jsxs)("div",{style:{maxWidth:1200,margin:"0 auto",padding:16},children:[s.jsx("h1",{style:{fontFamily:"Inter, sans-serif",fontSize:28,marginBottom:12},children:"Dashboard \xb7 M\xe9tricas Clave"}),(0,s.jsxs)("div",{style:{display:"grid",gap:12,gridTemplateColumns:"repeat(auto-fit,minmax(260px,1fr))"},children:[(0,s.jsxs)(o.Z,{title:"Participaci\xf3n",children:[(0,s.jsxs)("ul",{style:{lineHeight:1.8},children:[(0,s.jsxs)("li",{children:["Usuarios activos: ",s.jsx("b",{children:p(c?.active_users)})]}),(0,s.jsxs)("li",{children:["Posts: ",s.jsx("b",{children:p(c?.posts)})]}),(0,s.jsxs)("li",{children:["Votos: ",s.jsx("b",{children:p(c?.votes)})]})]}),s.jsx("div",{style:{marginTop:8,display:"flex",gap:8},children:s.jsx(l.z,{onClick:()=>i("participation"),children:"Exportar CSV"})})]}),(0,s.jsxs)(o.Z,{title:"Tiempos (respuesta)",children:[(0,s.jsxs)("ul",{style:{lineHeight:1.8},children:[(0,s.jsxs)("li",{children:["Promedio 1\xaa respuesta: ",(0,s.jsxs)("b",{children:[p(u?.avg_first_response_seconds),"s"]})]}),(0,s.jsxs)("li",{children:["P50: ",(0,s.jsxs)("b",{children:[p(u?.p50_seconds),"s"]})]}),(0,s.jsxs)("li",{children:["P90: ",(0,s.jsxs)("b",{children:[p(u?.p90_seconds),"s"]})]})]}),s.jsx("div",{style:{marginTop:8,display:"flex",gap:8},children:s.jsx(l.z,{onClick:()=>i("times"),children:"Exportar CSV"})})]}),(0,s.jsxs)(o.Z,{title:"Delegaci\xf3n",children:[(0,s.jsxs)("ul",{style:{lineHeight:1.8},children:[(0,s.jsxs)("li",{children:["Delegaciones activas: ",s.jsx("b",{children:p(h?.active_delegations)})]}),(0,s.jsxs)("li",{children:["Top delegados: ",s.jsx("b",{children:h?.top_delegates?.[0]?.user??"–"})]})]}),s.jsx("div",{style:{marginTop:8,display:"flex",gap:8},children:s.jsx(l.z,{onClick:()=>i("delegation"),children:"Exportar CSV"})})]})]}),s.jsx(o.Z,{title:"Tendencia de publicaciones (mock de ejemplo)",children:s.jsx(d.w,{data:r,xKey:"x",yKey:"y",height:280,"aria-label":"Tendencia de posts"})}),s.jsx("div",{style:{marginTop:8},children:s.jsx(l.z,{onClick:()=>i("summary"),children:"Exportar CSV (Resumen)"})}),(0,s.jsxs)("p",{style:{marginTop:8,color:"#6b7280"},children:["Actualizado: ",new Date(e?.generated_at||Date.now()).toLocaleString()]})]})}i()}catch(e){i(e)}})},4444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let i=r(5157),s=r(997),n=i._(r(6689)),a=r(6301);async function l(e){let{Component:t,ctx:r}=e;return{pageProps:await (0,a.loadGetInitialProps)(t,r)}}class o extends n.default.Component{render(){let{Component:e,pageProps:t}=this.props;return(0,s.jsx)(e,{...t})}}o.origGetInitialProps=l,o.getInitialProps=l,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3678:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},5941:e=>{e.exports=import("swr")},1017:e=>{e.exports=require("path")},4640:(e,t,r)=>{r.d(t,{w:()=>s});var i=r(997);function s({data:e,xKey:t,yKey:r,height:s=240,...n}){let a=e[0]?.data??[];if(0===a.length)return i.jsx("div",{style:{height:s},children:"No data"});let l=a.map(e=>e.y),o=Math.min(...l),d=Math.max(...l),c=e=>s-(s-20)*(e-o)/(d-o||1)-10,p=a.map((e,t)=>`${t/(a.length-1)*600},${c(e.y)}`).join(" ");return i.jsx("svg",{width:"100%",viewBox:`0 0 600 ${s}`,height:s,...n,children:i.jsx("polyline",{fill:"none",stroke:"#2563eb",strokeWidth:2,points:p})})}},2411:(e,t,r)=>{r.d(t,{z:()=>s});var i=r(997);function s(e){return i.jsx("button",{...e,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #ddd",background:"#fff",cursor:"pointer",...e.style||{}}})}},5457:(e,t,r)=>{r.d(t,{Z:()=>s});var i=r(997);function s({title:e,children:t}){return(0,i.jsxs)("div",{style:{border:"1px solid #eee",borderRadius:12,background:"#fff"},children:[e&&i.jsx("div",{style:{padding:"10px 14px",borderBottom:"1px solid #eee",fontWeight:600},children:e}),i.jsx("div",{style:{padding:"10px 14px"},children:t})]})}}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[176],()=>r(7095));module.exports=i})();