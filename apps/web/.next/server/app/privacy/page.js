(()=>{var e={};e.id=385,e.ids=[385],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7786:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>d,routeModule:()=>x,tree:()=>l}),s(4469),s(7850),s(8736);var a=s(2079),n=s(7619),r=s(6746),i=s.n(r),o=s(6767),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["privacy",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4469)),"C:\\GNEW3\\apps\\web\\app\\privacy\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,7850)),"C:\\GNEW3\\apps\\web\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,8736,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\GNEW3\\apps\\web\\app\\privacy\\page.tsx"],p="/privacy/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/privacy/page",pathname:"/privacy",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},9379:(e,t,s)=>{Promise.resolve().then(s.bind(s,2850))},173:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,312,23)),Promise.resolve().then(s.t.bind(s,5683,23)),Promise.resolve().then(s.t.bind(s,4144,23)),Promise.resolve().then(s.t.bind(s,414,23)),Promise.resolve().then(s.t.bind(s,6328,23)),Promise.resolve().then(s.t.bind(s,3582,23))},7233:()=>{},2850:(e,t,s)=>{"use strict";let a;s.r(t),s.d(t,{default:()=>m});var n=s(2911),r=s(7633);function i({subjectId:e,open:t,onClose:s}){let[a,i]=(0,r.useState)("v1"),[l,d]=(0,r.useState)({email:{marketing:!1},sms:{notifications:!1},push:{notifications:!1},onchain:{marketing:!1}}),p=async()=>{let t=[];for(let e of(t.push({purposeKey:"growth_marketing",dataCategoryKey:"email",processingUseKey:"marketing",channelKey:"email",state:l.email.marketing?"granted":"denied",policyVersion:a,provenance:"ui_flow"}),["sms","push"]))t.push({purposeKey:"account_access",dataCategoryKey:"phone",processingUseKey:"notifications",channelKey:e,state:l[e].notifications?"granted":"denied",policyVersion:a,provenance:"ui_flow"});t.push({purposeKey:"growth_marketing",dataCategoryKey:"wallet_id",processingUseKey:"marketing",channelKey:"onchain",state:l.onchain.marketing?"granted":"denied",policyVersion:a,provenance:"ui_flow"}),await fetch(`/api/consent/${e}/decisions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({decisions:t})}),s()};return t?n.jsx("div",{role:"dialog","aria-modal":!0,className:"fixed inset-0 bg-black/40  z-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-xl p-6  space-y-4",children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Preferencias por canal"}),n.jsx(o,{title:"Email",children:n.jsx(c,{label:"Marketing (boletines/ofertas)",checked:l.email.marketing,onChange:e=>d(t=>({...t,email:{...t.email,marketing:e}}))})}),(0,n.jsxs)(o,{title:"SMS / Push",children:[n.jsx(c,{label:"Notificaciones de seguridad y cuenta",checked:l.sms.notifications,onChange:e=>d(t=>({...t,sms:{notifications:e}}))}),n.jsx(c,{label:"Notificaciones push en app",checked:l.push.notifications,onChange:e=>d(t=>({...t,push:{notifications:e}}))})]}),n.jsx(o,{title:"On‑chain",children:n.jsx(c,{label:"Marketing (airdrops/POAPs)",checked:l.onchain.marketing,onChange:e=>d(t=>({...t,onchain:{marketing:e}}))})}),(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[n.jsx("button",{className:"px-4 py-2 border rounded",onClick:s,children:"Cancelar"}),n.jsx("button",{className:"px-4 py-2 bg-black text-white rounded",onClick:p,children:"Guardar"})]}),n.jsx("p",{className:"text-xs text-gray-500",children:"Tus cambios quedan auditados y puedes revocar en cualquier momento."})]})}):null}function o({title:e,children:t}){return(0,n.jsxs)("div",{className:"space-y-2",children:[n.jsx("h3",{className:"font-medium",children:e}),n.jsx("div",{className:"space-y-2",children:t})]})}function c({label:e,checked:t,onChange:s}){return(0,n.jsxs)("label",{className:"flex items-center justify-between p-3  border rounded-lg",children:[n.jsx("span",{className:"text-sm",children:e}),n.jsx("input",{type:"checkbox",checked:t,onChange:e=>s(e.target.checked)})]})}let l=e=>{let t;let s=new Set,a=(e,a)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=a?a:"object"!=typeof n||null===n)?n:Object.assign({},t,n),s.forEach(s=>s(t,e))}},n=()=>t,r={setState:a,getState:n,getInitialState:()=>i,subscribe:e=>(s.add(e),()=>s.delete(e))},i=t=e(a,n,r);return r},d=e=>e?l(e):l,p=e=>e,u=e=>{let t=d(e),s=e=>(function(e,t=p){let s=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(s),s})(t,e);return Object.assign(s,t),s},x=(a=(e,t)=>({loadCatalog:async()=>{let t=await fetch("/api/consent/catalog");e({catalog:await t.json()})},loadState:async t=>{let s=await fetch(`/api/consent/${t}`);e({state:await s.json()})},toggle:(s,a)=>{let n=t().state,r=n.records.find(e=>e.dataCategoryKey===s&&e.processingUseKey===a);r?r.state="granted"===r.state?"denied":"granted":n.records.push({dataCategoryKey:s,processingUseKey:a,state:"granted",policyVersion:t().catalog.matrixVersion}),e({state:{...n}})},save:async e=>{let s={decisions:t().state.records.map(e=>({purposeKey:"user_control",dataCategoryKey:e.dataCategoryKey,processingUseKey:e.processingUseKey,state:e.state,policyVersion:t().catalog.matrixVersion,provenance:"ui_center"}))};await fetch(`/api/consent/${e}/decisions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})}}))?u(a):u;function h({subjectId:e}){let{loadCatalog:t,loadState:s,catalog:a,state:r,toggle:i,save:o}=x();return a&&r?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("header",{children:[n.jsx("h1",{className:"text-2xl font-semibold",children:"Privacy & Consent"}),n.jsx("p",{className:"text-sm text-gray-500",children:"Control granular por dato/uso. Cambios quedan auditados."})]}),(0,n.jsxs)("table",{className:"w-full border-separate border-spacing-0",children:[n.jsx("thead",{children:(0,n.jsxs)("tr",{children:[n.jsx("th",{className:"text-left p-2 sticky top-0 bg-white",children:"Dato \\ Uso"}),a.uses.map(e=>n.jsx("th",{className:"p-2 text-left",children:e.title},e.key))]})}),n.jsx("tbody",{children:a.dataCategories.map(e=>(0,n.jsxs)("tr",{className:"border-t",children:[n.jsx("td",{className:"p-2 font-medium",children:e.title}),a.uses.map(t=>{let s=r.records.find(s=>s.dataCategoryKey===e.key&&s.processingUseKey===t.key),a=s?.state==="granted",o="strictly_necessary"===t.key;return n.jsx("td",{className:"p-2",children:(0,n.jsxs)("label",{className:"inline-flex items-center gap-2",children:[n.jsx("input",{"aria-label":`${e.title} → ${t.title}`,type:"checkbox",checked:a,disabled:o,onChange:()=>i(e.key,t.key)}),n.jsx("span",{className:"text-sm",children:a?"On":"Off"})]})},t.key)})]},e.key))})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{className:"px-4 py-2 rounded border",onClick:()=>o(e),children:"Guardar"}),n.jsx("a",{className:"px-4 py-2 rounded border",href:`/api/consent/${e}/export?fmt=csv`,children:"Descargar CSV"})]})]}):n.jsx("div",{role:"status","aria-busy":"true",children:"Loading…"})}function m(){let[e,t]=(0,r.useState)(!1),s="demo_subject";return(0,n.jsxs)("div",{className:"p-6 space-y-6",children:[n.jsx("h1",{className:"text-2xl font-semibold",children:"Privacidad y Consentimiento"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Gestiona por finalidad y canal. Descarga un recibo o revoca."}),n.jsx("button",{className:"px-4 py-2 border rounded",onClick:()=>t(!0),children:"Gestionar por canal"}),n.jsx(h,{subjectId:s}),n.jsx(i,{subjectId:s,open:e,onClose:()=>t(!1)})]})}},7850:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r,metadata:()=>n});var a=s(9429);let n={title:"GNEW Web"};function r({children:e}){return a.jsx("html",{lang:"es",children:a.jsx("body",{children:e})})}},4469:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>r,default:()=>o});var a=s(2604);let n=(0,a.createProxy)(String.raw`C:\GNEW3\apps\web\app\privacy\page.tsx`),{__esModule:r,$$typeof:i}=n;n.default;let o=(0,a.createProxy)(String.raw`C:\GNEW3\apps\web\app\privacy\page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[113],()=>s(7786));module.exports=a})();